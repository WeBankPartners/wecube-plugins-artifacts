<?xml version="1.0" encoding="UTF-8"?>
<package name="artifacts" version="{{VERSION}}"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="plugin-config-v2.xsd">

    <!-- 1.依赖分析 - 描述运行本插件包需要的其他插件包 -->
    <packageDependencies>
        <packageDependency name="platform" version="v2.5.0"/>
        <packageDependency name="wecmdb" version="v1.5.1"/>
    </packageDependencies>
         
    <!-- 2.菜单注入 - 描述运行本插件包需要注入的菜单 -->
    <menus>
        <menu code="IMPLEMENTATION_ARTIFACT_MANAGEMENT" cat="IMPLEMENTATION" displayName="Artifacts Management" localDisplayName="应用物料管理" >/artifacts/implementation/artifact-management</menu>
    </menus>

    <!-- 3.数据模型 - 描述本插件包的数据模型,并且描述和Framework数据模型的关系 -->
    <dataModel>
    </dataModel>

    <!-- 4.系统参数 - 描述运行本插件包需要的系统参数 -->
	<systemParameters>
        <systemParameter name="UPLOAD_ENABLED" scopeType="plugins" defaultValue="true"/>
        <systemParameter name="UPLOAD_NEXUS_ENABLED" scopeType="plugins" defaultValue="true"/>
        <systemParameter name="ARTIFACTS_CITYPE_SYSTEM_DESIGN" scopeType="plugins" defaultValue="37"/>
        <systemParameter name="ARTIFACTS_CITYPE_UNIT_DESIGN" scopeType="plugins" defaultValue="39"/>
        <systemParameter name="ARTIFACTS_CITYPE_DIFF_CONFIG" scopeType="plugins" defaultValue="44"/>
        <systemParameter name="ARTIFACTS_CITYPE_DEPLOY_PACKAGE" scopeType="plugins" defaultValue="45"/>
        <systemParameter name="ARTIFACTS_ENCRYPT_VARIBLE_PREFIX" scopeType="plugins" defaultValue="!,%"/>
        <systemParameter name="ARTIFACTS_FILE_VARIBLE_PREFIX" scopeType="plugins" defaultValue="^"/>
        <systemParameter name="ARTIFACTS_DEFAULT_SPECIAL_REPLACE" scopeType="plugins" defaultValue="@,#"/>
        <systemParameter name="LOCAL_NEXUS_SERVER_URL" scopeType="plugins" defaultValue="http://127.0.0.1:8081"/>
        <systemParameter name="LOCAL_NEXUS_USERNAME" scopeType="plugins" defaultValue="artifacts"/>
        <systemParameter name="LOCAL_NEXUS_PASSWORD" scopeType="plugins" defaultValue="artifacts"/>
        <systemParameter name="LOCAL_NEXUS_REPOSITORY" scopeType="plugins" defaultValue="artifacts"/>
        <systemParameter name="USE_REMOTE_NEXUS_ONLY" scopeType="plugins" defaultValue="false"/>
        <systemParameter name="CMDB_ARTIFACT_PATH" scopeType="plugins" defaultValue="artifact_path"/>
        <systemParameter name="NEXUS_SERVER_URL" scopeType="plugins" defaultValue="http://127.0.0.1:18888"/>
        <systemParameter name="NEXUS_USERNAME" scopeType="plugins" defaultValue="admin"/>
        <systemParameter name="NEXUS_PASSWORD" scopeType="plugins" defaultValue="admin123"/>
        <systemParameter name="NEXUS_REPOSITORY" scopeType="plugins" defaultValue="maven-releases"/>
	</systemParameters>

    <!-- 5.权限设定 -->
    <authorities>
        <authority systemRoleName="SUPER_ADMIN" >
            <menu code="IMPLEMENTATION_ARTIFACT_MANAGEMENT" />
        </authority >
    </authorities>

    <!-- 6.运行资源 - 描述部署运行本插件包需要的基础资源(如主机、虚拟机、容器、数据库等) -->
    <resourceDependencies>
        <docker imageName="{{REPOSITORY}}:{{VERSION}}" containerName="{{REPOSITORY}}-{{VERSION}}" portBindings="{{ALLOCATE_PORT}}:9000" volumeBindings="{{BASE_MOUNT_PATH}}/artifacts/log:/var/log/artifacts_corepy,{{BASE_MOUNT_PATH}}/certs:/certs,/etc/localtime:/etc/localtime"
        envVariables="ARTIFACTS_UPLOAD_ENABLED={{UPLOAD_ENABLED}},ARTIFACTS_UPLOAD_NEXUS_ENABLED={{UPLOAD_NEXUS_ENABLED}},
        ARTIFACTS_CITYPE_SYSTEM_DESIGN={{ARTIFACTS_CITYPE_SYSTEM_DESIGN}},ARTIFACTS_CITYPE_UNIT_DESIGN={{ARTIFACTS_CITYPE_UNIT_DESIGN}},
        ARTIFACTS_CITYPE_DIFF_CONFIG={{ARTIFACTS_CITYPE_DIFF_CONFIG}},ARTIFACTS_CITYPE_DEPLOY_PACKAGE={{ARTIFACTS_CITYPE_DEPLOY_PACKAGE}},
        ARTIFACTS_ENCRYPT_VARIBLE_PREFIX={{ARTIFACTS_ENCRYPT_VARIBLE_PREFIX}},ARTIFACTS_FILE_VARIBLE_PREFIX={{ARTIFACTS_FILE_VARIBLE_PREFIX}},
        ARTIFACTS_DEFAULT_SPECIAL_REPLACE={{ARTIFACTS_DEFAULT_SPECIAL_REPLACE}},
        ARTIFACTS_LOCAL_NEXUS_SERVER_URL={{LOCAL_NEXUS_SERVER_URL}},ARTIFACTS_LOCAL_NEXUS_USERNAME={{LOCAL_NEXUS_USERNAME}},
        ARTIFACTS_LOCAL_NEXUS_PASSWORD={{LOCAL_NEXUS_PASSWORD}},ARTIFACTS_LOCAL_NEXUS_REPOSITORY={{LOCAL_NEXUS_REPOSITORY}},
        ARTIFACTS_USE_REMOTE_NEXUS_ONLY={{USE_REMOTE_NEXUS_ONLY}},ARTIFACTS_CMDB_ARTIFACT_PATH={{CMDB_ARTIFACT_PATH}},
        ARTIFACTS_NEXUS_SERVER_URL={{NEXUS_SERVER_URL}},ARTIFACTS_NEXUS_USERNAME={{NEXUS_USERNAME}},
        ARTIFACTS_NEXUS_PASSWORD={{NEXUS_PASSWORD}},ARTIFACTS_NEXUS_REPOSITORY={{NEXUS_REPOSITORY}},
        WECUBE_S3_ACCESS_KEY={{S3_ACCESS_KEY}},WECUBE_S3_SECRET_KEY={{S3_SECRET_KEY}},
        WECUBE_GATEWAY_URL={{GATEWAY_URL}},WECUBE_JWT_SIGNING_KEY={{JWT_SIGNING_KEY}}"/>
        <s3 bucketName="wecube-artifacts"/>
    </resourceDependencies>

    <!-- 7.插件列表 - 描述插件包中单个插件的输入和输出 -->
    <plugins>
    </plugins>
</package>
